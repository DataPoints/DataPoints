

<div class="panel panel-default wrapper">
  <!-- Default panel contents -->

  <div class="panel-heading title">Your Datasets</div>
  <table border="0" class="table">
    <tr>
      <!--<th scope="col">N</th>-->
      <th scope="col">Name </th>
      <th scope="col">Description </th>
      <th scope="col">Status </th>
      <th scope="col">Created </th>
      <th scope="col">Updated </th>
      <th scope="col">Types </th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>

    <%i=0%>
    <% @Datasets.each do |dataset| %>
        <tr>
          <%i=i+1%>
          <!--<td><%=i%></td>-->
          <td type="edit"><%= dataset.name %></td>
          <td type="edit"><%= dataset.description %></td>
          <td>
            <% case dataset.status
                 when 'P' %><span class="label label-success">Successfully downloaded</span>
                <% when 'A' %><span class="label label-primary">Analyzed</span>
                <% when 'S' %><span class="label label-info">In process</span>
                <% when 'E' %> <span class="label label-danger">Error</span>
            <% end %>
          </td>
          <td><%= dataset.created_at.strftime("%d %b %H:%M") %></td>
          <td><%= dataset.updated_at.strftime("%d %b %H:%M") %></td>
          <td>
            <% types = @Types[dataset.id] %>
            <% if types.any? %>
              <% types.each do |type| %>
                <%= type %>,
              <% end %>
            <% else %>
                There are no types defined for this dataset
            <% end %>
          </td>
          <td>
            <%= dataset.analyzed_progress.to_s + "%"%>
          </td>
          <td><%= link_to 'Destroy', dataset_path(dataset),
                          method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <td><%= link_to 'Edit',  '#', 'data-target' => "#myModal_#{dataset.id}", 'data-toggle' => 'modal' %>

          <div class="modal fade" id='<%= "myModal_#{dataset.id}" %>' tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                  <h4 class="modal-title" id="myModalLabel">Edit</h4>
                </div>
                <div class="modal-body">
                  <%= render 'datasets/form', dataset: dataset, method: :get %>
                </div>
              </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
          </div><!-- /.modal -->
          </td>
          <td>
            <% if dataset.status == 'P' or dataset.status == 'A'%>
                <%= link_to 'Detail', dataset %>
            <% else %>
                Detail not available
            <% end %>
          </td>
      </tr>
    <%end%>
  </table>
  <div>
    <%= paginate @Datasets %>
  </div>
</div>
